\documentclass[letterpaper,titlepage,oneside]{report}
\usepackage[margin=1.0in]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{todonotes}
\usepackage{hyperref}
\usepackage{amsmath}
%% \usepackage{dcolumn}
%% \usepackage{amsfonts}
%% \usepackage{hyperref}
%% \usepackage{xcolor}
%% \setlength\parindent{0pt}

\begin{document}

\begin{titlepage}
  \centering
  \vspace*{\fill}
  {\huge\scshape ENPH 257 Lab Report\par}
  \vspace{1cm}
  {\large Brunette, Jacob\quad}
  {\large Fullerton, Dilyn\quad}
  {\large Watt, Ryan\quad}
  {\large Yao, Dickson\par}
  \vspace{1cm}
  {\large Instructor: Dr. Christopher Waltham\par}
  \vspace{1cm}
  {\large \today\par}
  \vspace*{\fill}
  \vfill
\end{titlepage}

\begin{abstract}
  hello world
  % TODO overview of the experiment and results (like Executive Summary)
\end{abstract}

\chapter{Introduction}
\label{ch:intro}
% TODO

\section{Conduction}
Heat diffusion due to conduction is given by the heat equation
\begin{equation}\label{eq:duconduction}
  \left(\frac{\partial}{\partial t}u(\mathbf{r},t)\right)_{\rm{cond}} =
  \frac{k}{c\rho}\nabla^2u(\mathbf{r}, t),
\end{equation}
where $u(\mathbf{r},t)$ is the temperature at position $\mathbf{r}$
and time $t$, $k$ is the thermal conductivity, $c$ is the specific
heat of the material, and $\rho$ is the mass density of the material.

\section{Convection}
Power gain due to convection for a differential surface element
at position $\mathbf{r}$ may be approximated by
\begin{equation}\label{eq:convectionpower}
  P_{\rm{conv}}(\mathbf{r},t) = -k_c\,\delta S(\mathbf{r})
  \left(u(\mathbf{r},t)-u_{\rm{amb}}\right),
\end{equation}
where $k_c$ is the convection coefficient, $\delta S(\mathbf{r})$ is
the differential surface element at $\mathbf{r}$, and $u_{\rm{amb}}$ is
the ambient temperature of the surrounding fluid.
\\\\
Now temperature change due to power for a differential mass element
is given by
\begin{equation}\label{eq:powertodu}
  P = \frac{\partial}{\partial t}Q = c\rho\,\delta V\frac{\partial}{\partial t}u,
\end{equation}
so the rate of change of temperature due to convection is given by
\begin{equation}\label{eq:duconvection}
  \left(\frac{\partial}{\partial t}u(\mathbf{r},t)\right)_{\rm{conv}} =
  -\frac{k_c\,\delta S(\mathbf{r})}{c\rho\,\delta V(\mathbf{r})}
  \left(u(\mathbf{r},t)-u_{\rm{amb}}\right).
\end{equation}

\section{Radiation}
Power gain due to radiation for a differential surface element at
position $\mathbf{r}$ is given by Planck's Law to be
\begin{equation}\label{eq:radiationpower}
  P_{\rm{rad}}(\mathbf{r},t) = -\epsilon\,\sigma\,\delta S(\mathbf{r})
  \left(u(\mathbf{r},t)^4-u_{\rm{amb}}^4\right),
\end{equation}
where $\epsilon$ is the emissivity and $\sigma$ is the Stefan-Boltzmann
constant.
\\\\
Again from Equation (\ref{eq:powertodu}), we can obtain the contribution
to the rate of change of temperature due to radiation
\begin{equation}\label{eq:duradiation}
  \left(\frac{\partial}{\partial t}u(\mathbf{r},t)\right)_{\rm{rad}} =
  -\frac{\epsilon\,\sigma\,\delta S(\mathbf{r})}{c\rho\,\delta V(\mathbf{r})}
  \left(u(\mathbf{r},t)^4-u_{\rm{amb}}^4\right).
\end{equation}

\section{Heat diffusion equation for a cylindrical rod}
For a one-dimensional cylindrical rod of length $L$ and radius
$R$, the heat diffusion equation is 
\begin{equation}\label{eq:heatdiffrod}
  \frac{\partial}{\partial t}u(x,t) =
  \frac{1}{c\rho}\left(
  k\frac{\partial^2}{\partial x^2}u(x, t)
  -k_c\frac{\delta S(x)}{\delta V(x)}
  \left(u(x,t)-u_{\rm{amb}}\right) 
  -\epsilon\,\sigma\frac{\delta S(x)}{\delta V(x)}
  \left(u(x,t)^4-u_{\rm{amb}}^4\right)
  +\frac{P_{\rm{in}}(x,t)}{\delta V(x)}
  \right),
\end{equation}
where $P_{\rm{in}}$ is the power input function.

\chapter{Objective}
\label{ch:objective}
%% TODO describe the goal of the experiment

\chapter{Method}
\label{ch:method}
%% TODO how did we do the experiment (such that someone else could reproduce it)

\section{Experimental setup}
%% TODO rod, circuit, thermocouples, etc

\subsection{Rod dimensions}
%% TODO

\subsection{Thermocouple circuit}
%% TODO

\section{Calibration}
%% TODO procedure for calibration of thermocouples

\section{Data aquisition}
%% TODO procedure for acquiring data

\chapter{Results}
\label{ch:results}
%% TODO

\chapter{Simulation and optimization}
\label{ch:simulation}

\section{One-dimensional explicit-step simulation}

The following is the finite difference equation
to simulate heat diffusion based on
Equation (\ref{eq:heatdiffrod}) for a cylindrical rod of
length $L$ and radius $R$. Based on the formalism in
Appendix \ref{ch:finitediff} and supposing x points
$\{x_i:i\in[0,X]\}$ and t points $\{t_n:n\in[0,T]\}$,
the explicit finite difference form
of Equation (\ref{eq:heatdiffrod}) is
\begin{equation}\label{eq:finitediffrod}
  \mathbf{u}^{n+1} = \mathbf{u}^n + \delta t \left(
  \delta\mathbf{u}_{\rm{cond}}^n +
  \delta\mathbf{u}_{\rm{conv}}^n +
  \delta\mathbf{u}_{\rm{rad}}^n +
  \delta\mathbf{u}_{\rm{pow}}^n \right),
\end{equation}
where
\begin{align*}
    \left(\delta \mathbf{u}_{\rm{cond}}^n\right)_i &=
    \frac{k}{c\rho}\cdot\frac{1}{\delta x^2}\cdot
    \begin{cases}
      \left(u_1^n-u_0^n\right), & \quad i=0\\
      \left(u_{X-1}^n-u_X^n\right), & \quad i=X\\
      \left(u_{i-1}^n-2u_i^n+u_{i+1}^n\right), & \quad \text{else}\\
    \end{cases}
    \\
    \left(\delta \mathbf{u}_{\rm{conv}}^n\right)_i &=
    -\frac{k_c}{c\rho}\cdot\frac{\delta S_i}{\delta V_i}
    \left(u_i^n-u_{\rm{amb}}\right)
    \\
    \left(\delta \mathbf{u}_{\rm{rad}}^n\right)_i &=
    -\frac{\epsilon\,\sigma}{c\rho}\cdot\frac{\delta S_i}{\delta V_i}
    \left((u_i^n)^4-u_{\rm{amb}^4}\right)
    \\
    \left(\delta \mathbf{u}_{\rm{pow}}^n\right)_i &=
    \frac{P_i^n}{c\rho\,\delta V_i}
\end{align*}
The differential volume at any point $x_i$ is the same
\begin{equation*}
  \delta V_i = \pi R^2\,\delta x.
\end{equation*}
The exposed surface is different at the ends, however, with
\begin{equation*}
  \delta S_i = 2\pi R\,\delta x +
  \begin{cases}
    \pi R^2, & \quad i=0 \text{ or } i=X\\
    0,       & \quad \text{else}\\
  \end{cases}
\end{equation*}
Finally power input occurs only at one end. It is assumed that
power is a constant $P_1$ during heating and $P_2$ during cooling.
Heating occurs until $t_{\rm{stop}}$ at which point cooling begins.
Thus we have
\begin{equation*}
  P_i^n =
  \begin{cases}
    P_1, & \quad t_0 < t_n < t_{\rm{stop}}\\
    P_2, & \quad t_{\rm{stop}} \leq t_n \leq t_T\\
  \end{cases}
\end{equation*}

\section{Optimization of one-dimensional simulation}
A numerical optimization routine was used to optimize
thermodynamical parameters by repeatedly varying these parameters,
running the one-dimensional simulation, and comparing the results to
experimental data until optimal parameters were achieved.
This optimization was run for each dataset. For each optimization,
67 positional points and a time step of .5 seconds were used.

\section{High-level simulation}
%% TODO SolidWorks simulation

\chapter{Analysis}
\label{ch:analysis}
%% TODO quality of data, fits, errors, uncertainty, and other considerations

\chapter{Conclusion and Summary}
\label{ch:conclusion}
%% TODO final conclusion: what did we learn and how is it relevant?

\appendix

%% TODO figure out how to site sources (and do it)

\chapter{Comparison of Finite Differencing Methods}
\label{ch:finitediff}
The following are methods of finite differencing, demonstrated
using the simple example of the one-dimensional heat conduction equation
\begin{equation}\label{eq:condsimp}
  \frac{\partial}{\partial t}u(x,t) = \alpha\frac{\partial^2}{\partial x^2}u(x,t).
\end{equation}

\section{Explicit method}

\subsection*{Finite difference equation}
In the explicit method for finite differencing, the temperature for
each spatial point can be independently determined from the previous
step. That is,
\begin{equation}\label{eq:explicit}
  u_i^{n+1} = u_i^n + \alpha\cdot\frac{\delta t}{\delta x^2}\cdot
  \left(u_{i-1}^n - 2u_i^n + u_{i+1}^n\right),
\end{equation}
where the superscript $n \in [0, T]$ signifies the step in time
$t_n$ and the
subscript $i \in [0, X]$ represents the position
$x_i$. $\delta t$ and $\delta x$
are the time steps in time and position respectively.
\\\\
If we define
\begin{equation*}
  \zeta = \alpha\cdot\frac{\delta t}{\delta x^2},
\end{equation*}
then this can be written as a linear relationship
\begin{equation}\label{eq:explicitlinear}
  \mathbf{u}^{n+1} = \mathbf{D}\mathbf{u}^{n},
\end{equation}
where $\mathbf{D}$ is the matrix defined by
\begin{equation}\label{eq:explicitdmatrix}
  \mathbf{D}_{ij} = 
  \begin{cases}
    \text{BC}, & \quad i=0 \text{ or } i=X \\
    \zeta,     & \quad 0<i<X \text{ and } |i-j|=1 \\
    1-2\zeta,  & \quad 0<i<X \text{ and } i-j=0 \\
    0,         & \quad \text{else} \\
  \end{cases}
\end{equation}
The top and bottom rows ($i=0$ and $i=X$) are determined from
boundary conditions. Note that as $\zeta$ approaches $0$,
$\mathbf{D}$ approaches the identity matrix. Thus $\zeta$ should be
as small as possible for the best approximtation. The condition for
stability is
\begin{equation*}
  0<\zeta<1.
\end{equation*}

\subsection*{Error in time}
The explicit method uses a forward difference in time. The
expression for the derivative approximation is derived from
the power series expansion in $\delta t$
\begin{equation}\label{eq:explicitexpansiondt}
  u(x,t+\delta t) = u(x,t) + \frac{\partial}{\partial t}u(x,t)\cdot\delta t
  + \frac{\partial^2}{\partial t^2}u(x,t)\cdot\frac{\delta t^2}{2!} + \dots
\end{equation}
Thus we have an approximation for the time derivative
\begin{equation}\label{eq:expliciterrdt}
  \frac{u(x,t+\delta t)-u(x,t)}{\delta t} = \frac{\partial}{\partial t}u(x,t)
  + O(\delta t).
\end{equation}
The error in time due to this approximation is linear in $\delta t$.

\subsection*{Error in position}
The explicit method uses a central second derivative in space. The
expression for the second derivative approximation is derived from
the power series expansion in $\delta x$.
\begin{equation}\label{eq:explicitexpansiondx}
  u(x+\delta x,t) = u(x,t) + \frac{\partial}{\partial x}u(x,t)\cdot\delta x +
  \frac{\partial^2}{\partial x^2}u(x,t)\cdot\frac{\delta x^2}{2!} +
  \frac{\partial^3}{\partial x^3}u(x,t)\cdot\frac{\delta x^3}{3!}
  + \dots
\end{equation}
At $-\delta x$, this is
\begin{equation*}
  u(x-\delta x,t) = u(x,t) - \frac{\partial}{\partial x}u(x,t)\cdot\delta x +
  \frac{\partial^2}{\partial x^2}u(x,t)\cdot\frac{\delta x^2}{2!} -
  \frac{\partial^3}{\partial x^3}u(x,t)\cdot\frac{\delta x^3}{3!}
  + \dots
\end{equation*}
Thus the approximation for the second spatial derivative is
\begin{equation}\label{eq:expliciterrdx}
  \frac{u(x-\delta x,t)-2u(x,t)+u(x+\delta x,t)}{\delta x^2} =
  \frac{\partial^2}{\partial x^2}u(x,t) + O(\delta x^2).
\end{equation}
The error in position due to this approximation is quadratic in $\delta x$.

\section{Implicit method}
%% TODO

\section{Crank-Nicolson method}
%% TODO

\end{document}
